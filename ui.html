<script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.10.7/dayjs.min.js"
  integrity="sha512-bwD3VD/j6ypSSnyjuaURidZksoVx3L1RPvTkleC48SbHCZsemT3VKMD39KknPnH728LLXVMTisESIBOAb5/W0Q=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
></script>
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
  integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
/>

<style>
  [x-cloak] {
    display: none !important;
  }
  body {
    font-family: sans-serif;
    padding: 10px;
  }
  input {
    display: block;
    width: 100%;
    padding: 8px 12px;
    border-radius: 4px;
    border: 1px solid #dddddd;
  }
  button:focus,
  input:focus {
    outline-color: #0e5faf;
  }
  .btn {
    padding: 8px 12px;
    border: 1px solid transparent;
    border-radius: 4px;
    transition: 0.2s;
  }
  .btn:hover {
    cursor: pointer;
  }
  .btn-blue {
    background: #0f2439;
    color: white;
  }
  .btn-blue:hover {
    background: #113253;
  }
  .btn-clear {
    padding: 8px 12px;
    border: 1px solid transparent;
    background: transparent;
  }
  .btn-clear:hover {
    background: #f8f8f8;
  }
  label {
    display: flex;
    justify-content: space-between;
  }
  .help {
    background: darkslategrey;
    width: 16px;
    height: 16px;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8em;
    text-decoration: none;
    color: white;
    font-weight: bold;
    transition: 0.4s;
  }
  .help:hover {
    background: black;
    box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.3);
  }
  .example {
    color: grey;
    font-size: 0.8em;
    margin-top: 0.3em;
  }
</style>

<script>
  const getDate = function () {
    let start = dayjs().subtract(2, "year").valueOf();
    let end = dayjs().add(2, "year").valueOf();
    let random = Math.floor(Math.random() * (end - start + 1)) + start;
    return new Date(random);
  };

  const insertDates = function (format) {
    let dates = [];
    for (let i = 0; i < 100; i++) {
      dates.push(dayjs(getDate()).format(format));
    }
    parent.postMessage({ pluginMessage: { type: "add-date", dates } }, "*");
  };

  const cancel = function () {
    parent.postMessage({ pluginMessage: { type: "cancel" } }, "*");
  };
</script>

<div x-data="{ format: 'YYYY-MM-DD' }" x-cloak>
  <form @submit.prevent="insertDates(format)">
    <h2>Placeholdate</h2>
    <label for="date"
      >Date Format
      <a
        class="help"
        title="day.js formatting documentation"
        href="https://day.js.org/docs/en/display/format"
        target="_blank"
        >?</a
      >
    </label>
    <input x-model="format" id="focus-me" x-init="$nextTick(() => { $el.focus(); $el.select() })" />
    <p class="example">
      <strong>Example Output: </strong
      ><span x-text="dayjs(getDate()).format(format)"></span>
    </p>
    <button class="btn btn-blue" type="submit">Insert Date</button>
    <button class="btn btn-clear" @click="cancel">Cancel</button>
  </form>
</div>
